# 单点登陆

TODO: add more detail

外部接口 -> Nginx -> Spring Gateway
在这一层上对 JWT 进行 Rule 的签名校验。这里就在 payload 中添加 角色信息。然后解开之后添加到内部调用链的头中。

Spring Gateway  可以和 Nginx 合并。

其实如果想要简单一些来看，可以抽离出一个 IAM 类型做权限校验的服务。emmmmmmmm 这个可能是后期体量比较大的情况下。

我最近想统一一下所有服务的账号，有几点想问一下

1. 注册时，不同子服务的注册信息不太一样。是每一个子服务一个注册页面的对吧？
2. 注销的时候，是直接请求用户服务那边全局注销，还是由子系统广播消息，部分注销？
3. 子服务的权限是在用户服务这一层，还是归在子服务上面。
4. 检索某个用户的时候，我目前的打算是在一个 API 聚合服务上面查找，然后通过聚合服务分别查子服务的接口来完成，还有什么其他的解法嘛？

两种系统设计都搞过 看公司自己的业务需求啦

1. 每个子服务注册的页面是同一个 支持不同的子服务的权限页面渲染
2. 全局注销（除非有特殊要求）
3. 如果做的比较精细 子服务的权限在用户服务这一层 一般可以通过 rbac 模型解决
4. 检索某个服务 通过接口入参来控制 网关设计上 有个聚合查询的参数 可以参考这个
